steps:
  V_CUSTOMER-1b8b36c2-f581-483e-97c5-e4253fe6e93c:
    operation:
      config:
        insertStrategy: UNION
        selectDistinct: false
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: FOOO
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 045b8949-67ec-40d0-9823-87d927c6a60f
              stepCounter: 1b8b36c2-f581-483e-97c5-e4253fe6e93c
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "15029"
                    stepCounter: "20335"
                transform: ""
          - columnReference:
              columnCounter: 8c512b2c-fd5c-4f1f-91dc-bdddccfa5ac2
              stepCounter: 1b8b36c2-f581-483e-97c5-e4253fe6e93c
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_NAME
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "15030"
                    stepCounter: "20335"
                transform: ""
          - columnReference:
              columnCounter: e4932b09-7781-46ed-8224-742e7b53cad7
              stepCounter: 1b8b36c2-f581-483e-97c5-e4253fe6e93c
            dataType: VARCHAR(40)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ADDRESS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "15031"
                    stepCounter: "20335"
                transform: ""
          - columnReference:
              columnCounter: 4ec65400-ea3a-4c2d-9e91-87d62330aa34
              stepCounter: 1b8b36c2-f581-483e-97c5-e4253fe6e93c
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_NATIONKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "15032"
                    stepCounter: "20335"
                transform: ""
          - columnReference:
              columnCounter: 1227dfa0-965f-45b3-adb2-26827353621f
              stepCounter: 1b8b36c2-f581-483e-97c5-e4253fe6e93c
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_PHONE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "15033"
                    stepCounter: "20335"
                transform: ""
          - columnReference:
              columnCounter: 3a715d47-92f9-4c65-a823-ea28cfd331e3
              stepCounter: 1b8b36c2-f581-483e-97c5-e4253fe6e93c
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_ACCTBAL
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "15034"
                    stepCounter: "20335"
                transform: ""
          - columnReference:
              columnCounter: 1bab8798-a064-4822-855c-b7f121e436c3
              stepCounter: 1b8b36c2-f581-483e-97c5-e4253fe6e93c
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_MKTSEGMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "15035"
                    stepCounter: "20335"
                transform: ""
          - columnReference:
              columnCounter: 01a9f694-f1c4-4200-984d-6dd47cf0e422
              stepCounter: 1b8b36c2-f581-483e-97c5-e4253fe6e93c
            dataType: VARCHAR(117)
            description: ""
            hashColumns: []
            hashDetails: null
            name: C_COMMENT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "15036"
                    stepCounter: "20335"
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: |-
                {{ stage('Override Create SQL') }}
                	CREATE OR REPLACE VIEW {{ ref('FOOO', 'V_CUSTOMER')}} AS (
                		SELECT 
                 C_CUSTKEY AS C_CUSTKEY,
                 C_NAME AS C_NAME,
                 C_ADDRESS AS C_ADDRESS,
                 C_NATIONKEY AS C_NATIONKEY,
                 C_PHONE AS C_PHONE,
                 C_ACCTBAL AS C_ACCTBAL,
                 C_MKTSEGMENT AS C_MKTSEGMENT,
                 C_COMMENT AS C_COMMENT
                 FROM {{ ref('SRC', 'CUSTOMER') }}
                	)
                	/*
                	CREATE OR REPLACE VIEW {{ ref('BRONZE_ORACLE_ERP', 'V_GW_ORDER_LINES_301')}} AS (
                		SELECT
                        NVL(ODRLINE.inventory_item_id,0)
                                || '-'
                                ||NVL(ODRLINE.ship_from_org_id, 9999) AS pk_product_wh_key ,
                        '301'
                                || '-'
                                || NVL(ODRLINE.invoice_to_customer_number, 'NOTDEFINED')
                                || '-'
                                || NVL(ODRLINE.invoice_to_site_use_id, 0) AS pk_customer_inv_to_site_key ,
                        '301'
                                || '-'
                                || (CASE WHEN NVL(ODRLINE.ship_to_customer_number,'NOTDEFINED') IN ('NA'         ,
                                                                                                    'ND'         ,
                                                                                                    'NOTDEFINED' ,
                                                                                                    'NOT_DEFINED',
                                                                                                    'NOT-DEFINED',
                                                                                                    'NOT DEFINED') THEN NVL(ODRLINE.invoice_to_customer_number,'NOTDEFINED') ELSE ODRLINE.ship_to_customer_number END)
                                || '-'
                                || (CASE WHEN NVL(ODRLINE.ship_to_customer_number,'NOTDEFINED') IN ('NA'                                                                                                                                                   ,
                                                                                                    'ND'                                                                                                                                                   ,
                                                                                                    'NOTDEFINED'                                                                                                                                           ,
                                                                                                    'NOT_DEFINED'                                                                                                                                          ,
                                                                                                    'NOT-DEFINED'                                                                                                                                          ,
                                                                                                    'NOT DEFINED') THEN NVL(ODRLINE.invoice_to_site_use_id, 0) ELSE ODRLINE.ship_to_site_use_id END) AS pk_customer_ship_to_site_key                       ,
                        '301'                                                                                                                                                                        AS bus_unit                                           ,
                        ODRLINE.header_id                                                                                                                                                            AS header_id                                          ,
                        ODRLINE.order_number                                                                                                                                                         AS order_number                                       ,
                        ODRHDR.order_type                                                                                                                                                            AS order_type                                         ,
                        ODRLINE.order_category                                                                                                                                                       AS order_category                                     ,
                        TO_DATE(ODRLINE.ordered_date)                                                                                                                                                AS ordered_date                                       ,
                        TO_DATE(ODRLINE.booked_date)                                                                                                                                                 AS booked_date                                        ,
                        ODRLINE.line_id                                                                                                                                                              AS line_id                                            ,
                        ODRLINE.line_number                                                                                                                                                          AS line_number                                        ,
                        ODRLINE.line_type_id                                                                                                                                                         AS line_type_id                                       ,
                        ODRLINE.line_type                                                                                                                                                            AS line_type                                          ,
                        ODRLINE.sold_from_org_id                                                                                                                                                     AS sold_from_org_id                                   ,
                        (CASE WHEN NVL(ODRLINE.sold_to_customer_number,'NOTDEFINED') IN ('NA'                                                                                                                                                              ,
                                                                                         'ND'                                                                                                                                                              ,
                                                                                         'NOTDEFINED'                                                                                                                                                      ,
                                                                                         'NOT_DEFINED'                                                                                                                                                     ,
                                                                                         'NOT-DEFINED'                                                                                                                                                     ,
                                                                                         'NOT DEFINED') THEN NVL(ODRLINE.invoice_to_customer_id,0) ELSE NVL(ODRLINE.sold_to_customer_id,0) END) AS sold_to_customer_id                                     ,
                        (CASE WHEN NVL(ODRLINE.sold_to_customer_number,'NOTDEFINED') IN ('NA'                                                                                                                                                              ,
                                                                                         'ND'                                                                                                                                                              ,
                                                                                         'NOTDEFINED'                                                                                                                                                      ,
                                                                                         'NOT_DEFINED'                                                                                                                                                     ,
                                                                                         'NOT-DEFINED'                                                                                                                                                     ,
                                                                                         'NOT DEFINED') THEN NVL(ODRLINE.invoice_to_customer_number,'NOTDEFINED') ELSE NVL(ODRLINE.sold_to_customer_number,'NOTDEFINED') END) AS sold_to_customer_number   ,
                        (CASE WHEN NVL(ODRLINE.sold_to_customer_number,'NOTDEFINED') IN ('NA'                                                                                                                                                              ,
                                                                                         'ND'                                                                                                                                                              ,
                                                                                         'NOTDEFINED'                                                                                                                                                      ,
                                                                                         'NOT_DEFINED'                                                                                                                                                     ,
                                                                                         'NOT-DEFINED'                                                                                                                                                     ,
                                                                                         'NOT DEFINED') THEN NVL(ODRLINE.invoice_to_customer,'NOTDEFINED') ELSE NVL(ODRLINE.sold_to_customer,'NOTDEFINED') END) AS sold_to_customer                        ,
                        NVL(ODRLINE.ship_from_org_id, 9999)                                                                                                                                                     AS ship_from_org_id                        ,
                        (CASE WHEN NVL(ODRLINE.ship_to_customer_number,'NOTDEFINED') IN ('NA'                                                                                                                                                              ,
                                                                                         'ND'                                                                                                                                                              ,
                                                                                         'NOTDEFINED'                                                                                                                                                      ,
                                                                                         'NOT_DEFINED'                                                                                                                                                     ,
                                                                                         'NOT-DEFINED'                                                                                                                                                     ,
                                                                                         'NOT DEFINED') THEN NVL(ODRLINE.invoice_to_site_use_id, 0) ELSE NVL(ODRLINE.ship_to_site_use_id, 0) END) AS ship_to_site_use_id                                   ,
                        (CASE WHEN NVL(ODRLINE.ship_to_customer_number,'NOTDEFINED') IN ('NA'                                                                                                                                                              ,
                                                                                         'ND'                                                                                                                                                              ,
                                                                                         'NOTDEFINED'                                                                                                                                                      ,
                                                                                         'NOT_DEFINED'                                                                                                                                                     ,
                                                                                         'NOT-DEFINED'                                                                                                                                                     ,
                                                                                         'NOT DEFINED') THEN NVL(ODRLINE.invoice_to_customer_id, 0) ELSE NVL(ODRLINE.ship_to_customer_id, 0) END) AS ship_to_customer_id                                   ,
                        (CASE WHEN NVL(ODRLINE.ship_to_customer_number,'NOTDEFINED') IN ('NA'                                                                                                                                                              ,
                                                                                         'ND'                                                                                                                                                              ,
                                                                                         'NOTDEFINED'                                                                                                                                                      ,
                                                                                         'NOT_DEFINED'                                                                                                                                                     ,
                                                                                         'NOT-DEFINED'                                                                                                                                                     ,
                                                                                         'NOT DEFINED') THEN NVL(ODRLINE.invoice_to_customer_number, 'NOTDEFINED') ELSE NVL(ODRLINE.ship_to_customer_number, 'NOTDEFINED') END) AS ship_to_customer_number ,
                        (CASE WHEN NVL(ODRLINE.ship_to_customer_number,'NOTDEFINED') IN ('NA'                                                                                                                                                              ,
                                                                                         'ND'                                                                                                                                                              ,
                                                                                         'NOTDEFINED'                                                                                                                                                      ,
                                                                                         'NOT_DEFINED'                                                                                                                                                     ,
                                                                                         'NOT-DEFINED'                                                                                                                                                     ,
                                                                                         'NOT DEFINED') THEN NVL(ODRLINE.invoice_to_customer,'NOTDEFINED') ELSE NVL(ODRLINE.ship_to_customer,'NOTDEFINED') END) AS ship_to_customer                        ,
                        (CASE WHEN NVL(ODRLINE.ship_to_customer_number,'NOTDEFINED') IN ('NA'                                                                                                                                                              ,
                                                                                         'ND'                                                                                                                                                              ,
                                                                                         'NOTDEFINED'                                                                                                                                                      ,
                                                                                         'NOT_DEFINED'                                                                                                                                                     ,
                                                                                         'NOT-DEFINED'                                                                                                                                                     ,
                                                                                         'NOT DEFINED') THEN NVL(ODRLINE.invoice_to_address_id,0) ELSE NVL(ODRLINE.ship_to_address_id,0) END)                                                                                                                                                                                                        AS ship_to_address_id                                        ,
                        NVL(ODRLINE.invoice_to_site_use_id, 0)                                                                                                                                                                                                                                                                                                                                       AS invoice_to_site_use_id                                    ,
                        ODRLINE.invoice_to_customer_id                                                                                                                                                                                                                                                                                                                                               AS invoice_to_customer_id                                    ,
                        NVL(ODRLINE.invoice_to_customer_number, 'NOTDEFINED')                                                                                                                                                                                                                                                                                                                        AS invoice_to_customer_number                                ,
                        ODRLINE.invoice_to_customer                                                                                                                                                                                                                                                                                                                                                  AS invoice_to_customer                                       ,
                        ODRLINE.invoice_to_address_id                                                                                                                                                                                                                                                                                                                                                AS invoice_to_address_id                                     ,
                        ODRLINE.salesrep_id                                                                                                                                                                                                                                                                                                                                                          AS salesrep_id                                               ,
                        ODRLINE.discount_type                                                                                                                                                                                                                                                                                                                                                        AS discount_type                                             ,
                        NVL(ODRHDR.transactional_curr_code, 'XXX')                                                                                                                                                                                                                                                                                                                                   AS transactional_curr_code                                   ,
                        ODRLINE.ordered_item                                                                                                                                                                                                                                                                                                                                                         AS ordered_item                                              ,
                        ODRLINE.request_date                                                                                                                                                                                                                                                                                                                                                         AS request_date                                              ,
                        ODRLINE.promise_date                                                                                                                                                                                                                                                                                                                                                         AS promise_date                                              ,
                        TO_DATE(NVL(ODRLINE.schedule_ship_date ,to_date('12/31/2099', 'mm/dd/yyyy')))                                                                                                                                                                                                                                                                                                AS schedule_ship_date                                        ,
                        ODRLINE.order_quantity_uom                                                                                                                                                                                                                                                                                                                                                   AS order_quantity_uom                                        ,
                        ODRLINE.pricing_quantity                                                                                                                                                                                                                                                                                                                                                     AS pricing_quantity                                          ,
                        ODRLINE.pricing_quantity_uom                                                                                                                                                                                                                                                                                                                                                 AS pricing_quantity_uom                                      ,
                        ODRLINE.cancelled_quantity                                                                                                                                                                                                                                                                                                                                                   AS cancelled_quantity                                        ,
                        ODRLINE.shipped_quantity                                                                                                                                                                                                                                                                                                                                                     AS shipped_quantity                                          ,
                        ODRLINE.ordered_quantity                                                                                                                                                                                                                                                                                                                                                     AS ordered_quantity                                          ,
                        ODRLINE.fulfilled_quantity                                                                                                                                                                                                                                                                                                                                                   AS fulfilled_quantity                                        ,
                        ODRLINE.shipping_quantity                                                                                                                                                                                                                                                                                                                                                    AS shipping_quantity                                         ,
                        ODRLINE.shipping_quantity_uom                                                                                                                                                                                                                                                                                                                                                AS shipping_quantity_uom                                     ,
                        ODRLINE.delivery_lead_time                                                                                                                                                                                                                                                                                                                                                   AS delivery_lead_time                                        ,
                        ODRLINE.tax_exempt_flag                                                                                                                                                                                                                                                                                                                                                      AS tax_exempt_flag                                           ,
                        ODRLINE.tax_exempt_number                                                                                                                                                                                                                                                                                                                                                    AS tax_exempt_number                                         ,
                        ODRLINE.tax_exempt_reason_code                                                                                                                                                                                                                                                                                                                                               AS tax_exempt_reason_code                                    ,
                        ODRLINE.ship_to_contact_id                                                                                                                                                                                                                                                                                                                                                   AS ship_to_contact_id                                        ,
                        ODRLINE.deliver_to_contact_id                                                                                                                                                                                                                                                                                                                                                AS deliver_to_contact_id                                     ,
                        ODRLINE.invoice_to_contact_id                                                                                                                                                                                                                                                                                                                                                AS invoice_to_contact_id                                     ,
                        ODRLINE.intmed_ship_to_org_id                                                                                                                                                                                                                                                                                                                                                AS intmed_ship_to_org_id                                     ,
                        ODRLINE.intmed_ship_to_contact_id                                                                                                                                                                                                                                                                                                                                            AS intmed_ship_to_contact_id                                 ,
                        ODRLINE.cust_po_number                                                                                                                                                                                                                                                                                                                                                       AS cust_po_number                                            ,
                        ODRLINE.ship_tolerance_above                                                                                                                                                                                                                                                                                                                                                 AS ship_tolerance_above                                      ,
                        ODRLINE.ship_tolerance_below                                                                                                                                                                                                                                                                                                                                                 AS ship_tolerance_below                                      ,
                        ODRLINE.demand_bucket_type_code                                                                                                                                                                                                                                                                                                                                              AS demand_bucket_type_code                                   ,
                        ODRLINE.veh_cus_item_cum_key_id                                                                                                                                                                                                                                                                                                                                              AS veh_cus_item_cum_key_id                                      ,
                        ODRLINE.rla_schedule_type_code                                                                                                                                                                                                                                                                                                                                               AS rla_schedule_type_code                                    ,
                        ODRLINE.customer_dock_code                                                                                                                                                                                                                                                                                                                                                   AS customer_dock_code                                        ,
                        ODRLINE.customer_job                                                                                                                                                                                                                                                                                                                                                         AS customer_job                                              ,
                        ODRLINE.customer_production_line                                                                                                                                                                                                                                                                                                                                             AS customer_production_line                                  ,
                        ODRLINE.cust_model_serial_number                                                                                                                                                                                                                                                                                                                                             AS cust_model_serial_number                                  ,
                        ODRLINE.project_id                                                                                                                                                                                                                                                                                                                                                           AS product_id                                                ,
                        ODRLINE.task_id                                                                                                                                                                                                                                                                                                                                                              AS task_id                                                   ,
                        NVL(ODRLINE.inventory_item_id,0)                                                                                                                                                                                                                                                                                                                                             AS inventory_item_id                                         ,
                        NVL(ODRLINE.product_number, 'NOTDEFINED')                                                                                                                                                                                                                                                                                                                                    AS product_number                                            ,
                        ODRLINE.tax_date                                                                                                                                                                                                                                                                                                                                                             AS tax_date                                                  ,
                        ODRLINE.tax_code                                                                                                                                                                                                                                                                                                                                                             AS tax_code                                                  ,
                        ODRLINE.tax_rate                                                                                                                                                                                                                                                                                                                                                             AS tax_rate                                                  ,
                        ODRLINE.invoice_interface_status_code                                                                                                                                                                                                                                                                                                                                        AS invoice_interface_status_code                             ,
                        ODRLINE.demand_class_code                                                                                                                                                                                                                                                                                                                                                    AS demand_class_code                                         ,
                        ODRLINE.price_list_id                                                                                                                                                                                                                                                                                                                                                        AS price_list_id                                             ,
                        ODRLINE.price_list                                                                                                                                                                                                                                                                                                                                                           AS price_list                                                ,
                        ODRLINE.pricing_date                                                                                                                                                                                                                                                                                                                                                         AS pricing_date                                              ,
                        ODRLINE.shipment_number                                                                                                                                                                                                                                                                                                                                                      AS shipment_number                                           ,
                        ODRLINE.agreement_id                                                                                                                                                                                                                                                                                                                                                         AS agreement_id                                              ,
                        ODRLINE.shipment_priority_code                                                                                                                                                                                                                                                                                                                                               AS shipment_priority_code                                    ,
                        ODRLINE.shipping_method_code                                                                                                                                                                                                                                                                                                                                                 AS shipping_method_code                                      ,
                        ODRLINE.freight_carrier_code                                                                                                                                                                                                                                                                                                                                                 AS freight_carrier_code                                      ,
                        ODRLINE.freight_terms_code                                                                                                                                                                                                                                                                                                                                                   AS freight_terms_code                                        ,
                        ODRLINE.fob_point_code                                                                                                                                                                                                                                                                                                                                                       AS fob_point_code                                            ,
                        ODRLINE.tax_point_code                                                                                                                                                                                                                                                                                                                                                       AS tax_point_code                                            ,
                        ODRLINE.payment_term_id                                                                                                                                                                                                                                                                                                                                                      AS payment_term_id                                           ,
                        ODRLINE.invoicing_rule_id                                                                                                                                                                                                                                                                                                                                                    AS invoicing_rule_id                                         ,
                        ODRLINE.accounting_rule_id                                                                                                                                                                                                                                                                                                                                                   AS accounting_rule_id                                        ,
                        ODRLINE.source_document_type_id                                                                                                                                                                                                                                                                                                                                              AS source_document_type_id                                   ,
                        ODRLINE.orig_sys_document_ref                                                                                                                                                                                                                                                                                                                                                AS orig_sys_document_ref                                     ,
                        ODRLINE.source_document_id                                                                                                                                                                                                                                                                                                                                                   AS source_document_id                                        ,
                        ODRLINE.orig_sys_line_ref                                                                                                                                                                                                                                                                                                                                                    AS orig_sys_line_ref                                         ,
                        ODRLINE.source_document_line_id                                                                                                                                                                                                                                                                                                                                              AS source_document_line_id                                   ,
                        ODRLINE.reference_line_id                                                                                                                                                                                                                                                                                                                                                    AS reference_line_id                                         ,
                        ODRLINE.reference_type                                                                                                                                                                                                                                                                                                                                                       AS reference_type                                            ,
                        ODRLINE.reference_header_id                                                                                                                                                                                                                                                                                                                                                  AS reference_header_id                                       ,
                        ODRLINE.item_revision                                                                                                                                                                                                                                                                                                                                                        AS item_revision                                             ,
                        ODRLINE.unit_selling_price                                                                                                                                                                                                                                                                                                                                                   AS unit_selling_price                                        ,
                        ODRLINE.unit_list_price                                                                                                                                                                                                                                                                                                                                                      AS unit_list_price                                           ,
                        ODRLINE.discount_price                                                                                                                                                                                                                                                                                                                                                       AS discount_price                                            ,
                        ODRLINE.tax_value                                                                                                                                                                                                                                                                                                                                                            AS tax_value                                                 ,
                        ODRLINE.context                                                                                                                                                                                                                                                                                                                                                              AS context                                                   ,
                        ODRLINE.attribute1                                                                                                                                                                                                                                                                                                                                                           AS attribute1                                                ,
                        ODRLINE.attribute2                                                                                                                                                                                                                                                                                                                                                           AS attribute2                                                ,
                        ODRLINE.attribute3                                                                                                                                                                                                                                                                                                                                                           AS attribute3                                                ,
                        ODRLINE.attribute4                                                                                                                                                                                                                                                                                                                                                           AS attribute4                                                ,
                        ODRLINE.attribute5                                                                                                                                                                                                                                                                                                                                                           AS attribute5                                                ,
                        ODRLINE.attribute6                                                                                                                                                                                                                                                                                                                                                           AS attribute6                                                ,
                        ODRLINE.attribute7                                                                                                                                                                                                                                                                                                                                                           AS attribute7                                                ,
                        ODRLINE.attribute8                                                                                                                                                                                                                                                                                                                                                           AS attribute8                                                ,
                        ODRLINE.attribute9                                                                                                                                                                                                                                                                                                                                                           AS attribute9                                                ,
                        ODRLINE.attribute10                                                                                                                                                                                                                                                                                                                                                          AS attribute10                                               ,
                        ODRLINE.attribute11                                                                                                                                                                                                                                                                                                                                                          AS attribute11                                               ,
                        ODRLINE.attribute12                                                                                                                                                                                                                                                                                                                                                          AS attribute12                                               ,
                        ODRLINE.attribute13                                                                                                                                                                                                                                                                                                                                                          AS attribute13                                               ,
                        ODRLINE.attribute14                                                                                                                                                                                                                                                                                                                                                          AS attribute14                                               ,
                        ODRLINE.attribute15                                                                                                                                                                                                                                                                                                                                                          AS attribute15                                               ,
                        ODRLINE.pricing_context                                                                                                                                                                                                                                                                                                                                                      AS pricing_context                                           ,
                        ODRLINE.pricing_attribute1                                                                                                                                                                                                                                                                                                                                                   AS pricing_attribute1                                        ,
                        ODRLINE.pricing_attribute2                                                                                                                                                                                                                                                                                                                                                   AS pricing_attribute2                                        ,
                        ODRLINE.pricing_attribute3                                                                                                                                                                                                                                                                                                                                                   AS pricing_attribute3                                        ,
                        ODRLINE.pricing_attribute4                                                                                                                                                                                                                                                                                                                                                   AS pricing_attribute4                                        ,
                        ODRLINE.pricing_attribute5                                                                                                                                                                                                                                                                                                                                                   AS pricing_attribute5                                        ,
                        ODRLINE.pricing_attribute6                                                                                                                                                                                                                                                                                                                                                   AS pricing_attribute6                                        ,
                        ODRLINE.pricing_attribute7                                                                                                                                                                                                                                                                                                                                                   AS pricing_attribute7                                        ,
                        ODRLINE.pricing_attribute8                                                                                                                                                                                                                                                                                                                                                   AS pricing_attribute8                                        ,
                        ODRLINE.pricing_attribute9                                                                                                                                                                                                                                                                                                                                                   AS pricing_attribute9                                        ,
                        ODRLINE.pricing_attribute10                                                                                                                                                                                                                                                                                                                                                  AS pricing_attribute10                                       ,
                        ODRLINE.creation_date                                                                                                                                                                                                                                                                                                                                                        AS creation_date                                             ,
                        ODRLINE.created_by                                                                                                                                                                                                                                                                                                                                                           AS created_by                                                ,
                        ODRLINE.last_update_date                                                                                                                                                                                                                                                                                                                                                     AS last_update_date                                          ,
                        ODRLINE.last_updated_by                                                                                                                                                                                                                                                                                                                                                      AS last_updated_by                                           ,
                        ODRLINE.last_update_login                                                                                                                                                                                                                                                                                                                                                    AS last_update_login                                         ,
                        ODRLINE.request_id                                                                                                                                                                                                                                                                                                                                                           AS request_id                                                ,
                        ODRLINE.top_model_line_id                                                                                                                                                                                                                                                                                                                                                    AS top_model_line_id                                         ,
                        ODRLINE.link_to_line_id                                                                                                                                                                                                                                                                                                                                                      AS link_to_line_id                                           ,
                        ODRLINE.component_sequence_id                                                                                                                                                                                                                                                                                                                                                AS component_sequence_id                                     ,
                        ODRLINE.component_code                                                                                                                                                                                                                                                                                                                                                       AS component_code                                            ,
                        ODRLINE.config_display_sequence                                                                                                                                                                                                                                                                                                                                              AS config_display_sequence                                   ,
                        ODRLINE.sort_order                                                                                                                                                                                                                                                                                                                                                           AS sort_order                                                ,
                        ODRLINE.item_type_code                                                                                                                                                                                                                                                                                                                                                       AS item_type_code                                            ,
                        ODRLINE.option_number                                                                                                                                                                                                                                                                                                                                                        AS option_number                                             ,
                        ODRLINE.option_flag                                                                                                                                                                                                                                                                                                                                                          AS option_flag                                               ,
                        ODRLINE.dep_plan_required_flag                                                                                                                                                                                                                                                                                                                                               AS dep_plan_required_flag                                    ,
                        ODRLINE.visible_demand_flag                                                                                                                                                                                                                                                                                                                                                  AS visible_demand_flag                                       ,
                        ODRLINE.line_category_code                                                                                                                                                                                                                                                                                                                                                   AS line_category_code                                        ,
                        ODRLINE.actual_shipment_date                                                                                                                                                                                                                                                                                                                                                 AS actual_shipment_date                                      ,
                        ODRLINE.customer_trx_line_id                                                                                                                                                                                                                                                                                                                                                 AS customer_trx_line_id                                      ,
                        ODRLINE.return_context                                                                                                                                                                                                                                                                                                                                                       AS return_context                                            ,
                        ODRLINE.return_attribute1                                                                                                                                                                                                                                                                                                                                                    AS return_attribute1                                         ,
                        ODRLINE.return_attribute2                                                                                                                                                                                                                                                                                                                                                    AS return_attribute2                                         ,
                        ODRLINE.return_attribute3                                                                                                                                                                                                                                                                                                                                                    AS return_attribute3                                         ,
                        ODRLINE.return_attribute4                                                                                                                                                                                                                                                                                                                                                    AS return_attribute4                                         ,
                        ODRLINE.return_attribute5                                                                                                                                                                                                                                                                                                                                                    AS return_attribute5                                         ,
                        ODRLINE.return_attribute6                                                                                                                                                                                                                                                                                                                                                    AS return_attribute6                                         ,
                        ODRLINE.return_attribute7                                                                                                                                                                                                                                                                                                                                                    AS return_attribute7                                         ,
                        ODRLINE.return_attribute8                                                                                                                                                                                                                                                                                                                                                    AS return_attribute8                                         ,
                        ODRLINE.return_attribute9                                                                                                                                                                                                                                                                                                                                                    AS return_attribute9                                         ,
                        ODRLINE.return_attribute10                                                                                                                                                                                                                                                                                                                                                   AS return_attribute10                                        ,
                        ODRLINE.return_attribute11                                                                                                                                                                                                                                                                                                                                                   AS return_attribute11                                        ,
                        ODRLINE.return_attribute12                                                                                                                                                                                                                                                                                                                                                   AS return_attribute12                                        ,
                        ODRLINE.return_attribute13                                                                                                                                                                                                                                                                                                                                                   AS return_attribute13                                        ,
                        ODRLINE.return_attribute14                                                                                                                                                                                                                                                                                                                                                   AS return_attribute14                                        ,
                        ODRLINE.return_attribute15                                                                                                                                                                                                                                                                                                                                                   AS return_attribute15                                        ,
                        ODRLINE.actual_arrival_date                                                                                                                                                                                                                                                                                                                                                  AS actual_arrival_date                                       ,
                        ODRLINE.ato_line_id                                                                                                                                                                                                                                                                                                                                                          AS ato_line_id                                               ,
                        ODRLINE.auto_selected_quantity                                                                                                                                                                                                                                                                                                                                               AS auto_selected_quantity                                    ,
                        ODRLINE.component_number                                                                                                                                                                                                                                                                                                                                                     AS component_number                                          ,
                        ODRLINE.earliest_acceptable_date                                                                                                                                                                                                                                                                                                                                             AS earliest_acceptable_date                                  ,
                        ODRLINE.explosion_date                                                                                                                                                                                                                                                                                                                                                       AS explosion_date                                            ,
                        ODRLINE.latest_acceptable_date                                                                                                                                                                                                                                                                                                                                               AS latest_acceptable_date                                    ,
                        ODRLINE.model_group_number                                                                                                                                                                                                                                                                                                                                                   AS model_group_number                                        ,
                        ODRLINE.schedule_arrival_date                                                                                                                                                                                                                                                                                                                                                AS schedule_arrival_date                                     ,
                        ODRLINE.ship_model_complete_flag                                                                                                                                                                                                                                                                                                                                             AS ship_model_complete_flag                                  ,
                        ODRLINE.schedule_status_code                                                                                                                                                                                                                                                                                                                                                 AS schedule_status_code                                      ,
                        ODRLINE.source_type_code                                                                                                                                                                                                                                                                                                                                                     AS source_type_code                                          ,
                        ODRLINE.cancelled_date                                                                                                                                                                                                                                                                                                                                                       AS cancelled_date                                            ,
                        ODRLINE.cancelled_flag                                                                                                                                                                                                                                                                                                                                                       AS cancelled_flag                                            ,
                        ODRLINE.open_flag                                                                                                                                                                                                                                                                                                                                                            AS open_flag                                                 ,
                        ODRLINE.booked_flag                                                                                                                                                                                                                                                                                                                                                          AS booked_flag                                               ,
                        ODRLINE.return_reason_code                                                                                                                                                                                                                                                                                                                                                   AS return_reason_code                                        ,
                        ODRLINE.arrival_set_id                                                                                                                                                                                                                                                                                                                                                       AS arrival_set_id                                            ,
                        ODRLINE.ship_set_id                                                                                                                                                                                                                                                                                                                                                          AS ship_set_id                                               ,
                        ODRLINE.split_from_line_id                                                                                                                                                                                                                                                                                                                                                   AS split_from_line_id                                        ,
                        ODRLINE.cust_production_seq_num                                                                                                                                                                                                                                                                                                                                              AS cust_production_seq_num                                   ,
                        ODRLINE.authorized_to_ship_flag                                                                                                                                                                                                                                                                                                                                              AS authorized_to_ship_flag                                   ,
                        ODRLINE.over_ship_reason_code                                                                                                                                                                                                                                                                                                                                                AS over_ship_reason_code                                     ,
                        ODRLINE.over_ship_resolved_flag                                                                                                                                                                                                                                                                                                                                              AS over_ship_resolved_flag                                   ,
                        ODRLINE.ordered_item_id                                                                                                                                                                                                                                                                                                                                                      AS ordered_item_id                                           ,
                        ODRLINE.item_identifier_type                                                                                                                                                                                                                                                                                                                                                 AS item_identifier_type                                      ,
                        ODRLINE.configuration_id                                                                                                                                                                                                                                                                                                                                                     AS configuration_id                                          ,
                        ODRLINE.commitment_id                                                                                                                                                                                                                                                                                                                                                        AS commitment_id                                             ,
                        ODRLINE.shipping_interfaced_flag                                                                                                                                                                                                                                                                                                                                             AS shipping_interfaced_flag                                  ,
                        ODRLINE.credit_invoice_line_id                                                                                                                                                                                                                                                                                                                                               AS credit_invoice_line_id                                    ,
                        ODRLINE.first_ack_code                                                                                                                                                                                                                                                                                                                                                       AS first_ack_code                                            ,
                        ODRLINE.first_ack_date                                                                                                                                                                                                                                                                                                                                                       AS first_ack_date                                            ,
                        ODRLINE.last_ack_code                                                                                                                                                                                                                                                                                                                                                        AS last_ack_code                                             ,
                        ODRLINE.last_ack_date                                                                                                                                                                                                                                                                                                                                                        AS last_ack_date                                             ,
                        ODRLINE.planning_priority                                                                                                                                                                                                                                                                                                                                                    AS planning_priority                                         ,
                        ODRLINE.order_source_id                                                                                                                                                                                                                                                                                                                                                      AS order_source_id                                           ,
                        ODRLINE.orig_sys_shipment_ref                                                                                                                                                                                                                                                                                                                                                AS orig_sys_shipment_ref                                     ,
                        ODRLINE.change_sequence                                                                                                                                                                                                                                                                                                                                                      AS change_sequence                                           ,
                        ODRLINE.drop_ship_flag                                                                                                                                                                                                                                                                                                                                                       AS drop_ship_flag                                            ,
                        ODRLINE.customer_line_number                                                                                                                                                                                                                                                                                                                                                 AS customer_line_number                                      ,
                        ODRLINE.customer_shipment_number                                                                                                                                                                                                                                                                                                                                             AS customer_shipment_number                                  ,
                        ODRLINE.customer_item_net_price                                                                                                                                                                                                                                                                                                                                              AS customer_item_net_price                                   ,
                        ODRLINE.customer_payment_term_id                                                                                                                                                                                                                                                                                                                                             AS customer_payment_term_id                                  ,
                        ODRLINE.fulfilled_flag                                                                                                                                                                                                                                                                                                                                                       AS fulfilled_flag                                            ,
                        ODRLINE.end_item_unit_number                                                                                                                                                                                                                                                                                                                                                 AS end_item_unit_number                                      ,
                        ODRLINE.config_header_id                                                                                                                                                                                                                                                                                                                                                     AS config_header_id                                          ,
                        ODRLINE.config_rev_nbr                                                                                                                                                                                                                                                                                                                                                       AS config_rev_nbr                                            ,
                        ODRLINE.mfg_component_sequence_id                                                                                                                                                                                                                                                                                                                                            AS mfg_component_sequence_id                                 ,
                        ODRLINE.shipping_instructions                                                                                                                                                                                                                                                                                                                                                AS shipping_instructions                                     ,
                        ODRHDR.packing_instructions                                                                                                                                                                                                                                                                                                                                                  AS packing_instructions                                      ,
                        ODRLINE.invoiced_quantity                                                                                                                                                                                                                                                                                                                                                    AS invoiced_quantity                                         ,
                        ODRLINE.reference_customer_trx_line_id                                                                                                                                                                                                                                                                                                                                       AS reference_customer_trx_line_id                            ,
                        ODRLINE.split_by                                                                                                                                                                                                                                                                                                                                                             AS split_by                                                  ,
                        ODRLINE.line_set_id                                                                                                                                                                                                                                                                                                                                                          AS line_set_id                                               ,
                        ODRLINE.service_txn_reason_code                                                                                                                                                                                                                                                                                                                                              AS service_txn_reason_code                                   ,
                        ODRLINE.service_txn_comments                                                                                                                                                                                                                                                                                                                                                 AS service_txn_comments                                      ,
                        ODRLINE.service_duration                                                                                                                                                                                                                                                                                                                                                     AS service_duration                                          ,
                        ODRLINE.service_start_date                                                                                                                                                                                                                                                                                                                                                   AS service_start_date                                        ,
                        ODRLINE.service_end_date                                                                                                                                                                                                                                                                                                                                                     AS service_end_date                                          ,
                        ODRLINE.service_coterminate_flag                                                                                                                                                                                                                                                                                                                                             AS service_coterminate_flag                                  ,
                        ODRLINE.unit_list_percent                                                                                                                                                                                                                                                                                                                                                    AS unit_list_percent                                         ,
                        ODRLINE.unit_selling_percent                                                                                                                                                                                                                                                                                                                                                 AS unit_selling_percent                                      ,
                        ODRLINE.unit_percent_base_price                                                                                                                                                                                                                                                                                                                                              AS unit_percent_base_price                                   ,
                        ODRLINE.service_number                                                                                                                                                                                                                                                                                                                                                       AS service_number                                            ,
                        ODRLINE.service_period                                                                                                                                                                                                                                                                                                                                                       AS service_period                                            ,
                        ODRLINE.shippable_flag                                                                                                                                                                                                                                                                                                                                                       AS shippable_flag                                            ,
                        ODRLINE.model_remnant_flag                                                                                                                                                                                                                                                                                                                                                   AS model_remnant_flag                                        ,
                        ODRLINE.re_source_flag                                                                                                                                                                                                                                                                                                                                                       AS re_source_flag                                            ,
                        ODRLINE.flow_status_code                                                                                                                                                                                                                                                                                                                                                     AS flow_status_code                                          ,
                        ODRLINE.fulfillment_method_code                                                                                                                                                                                                                                                                                                                                              AS fulfillment_method_code                                   ,
                        ODRLINE.marketing_source_code_id                                                                                                                                                                                                                                                                                                                                             AS marketing_source_code_id                                  ,
                        ODRLINE.service_reference_type_code                                                                                                                                                                                                                                                                                                                                          AS service_reference_type_code                               ,
                        ODRLINE.service_reference_line_id                                                                                                                                                                                                                                                                                                                                            AS service_reference_line_id                                 ,
                        ODRLINE.service_reference_system_id                                                                                                                                                                                                                                                                                                                                          AS service_reference_system_id                               ,
                        ODRLINE.calculate_price_flag                                                                                                                                                                                                                                                                                                                                                 AS calculate_price_flag                                      ,
                        ODRLINE.upgraded_flag                                                                                                                                                                                                                                                                                                                                                        AS upgraded_flag                                             ,
                        ODRLINE.revenue_amount                                                                                                                                                                                                                                                                                                                                                       AS revenue_amount                                            ,
                        ODRLINE.fulfillment_date                                                                                                                                                                                                                                                                                                                                                     AS fulfillment_date                                          ,
                        ODRLINE.preferred_grade                                                                                                                                                                                                                                                                                                                                                      AS preferred_grade                                           ,
                        ODRLINE.ordered_quantity2                                                                                                                                                                                                                                                                                                                                                    AS ordered_quantity2                                         ,
                        ODRLINE.ordered_quantity_uom2                                                                                                                                                                                                                                                                                                                                                AS ordered_quantity_uom2                                     ,
                        ODRLINE.shipping_quantity2                                                                                                                                                                                                                                                                                                                                                   AS shipping_quantity2                                        ,
                        ODRLINE.cancelled_quantity2                                                                                                                                                                                                                                                                                                                                                  AS cancelled_quantity2                                       ,
                        ODRLINE.shipped_quantity2                                                                                                                                                                                                                                                                                                                                                    AS shipped_quantity2                                         ,
                        ODRLINE.shipping_quantity_uom2                                                                                                                                                                                                                                                                                                                                               AS shipping_quantity_uom2                                    ,
                        ODRLINE.fulfilled_quantity2                                                                                                                                                                                                                                                                                                                                                  AS fulfilled_quantity2                                       ,
                        ODRLINE.mfg_lead_time                                                                                                                                                                                                                                                                                                                                                        AS mfg_lead_time                                             ,
                        ODRLINE.lock_control                                                                                                                                                                                                                                                                                                                                                         AS lock_control                                              ,
                        ODRLINE.subinventory                                                                                                                                                                                                                                                                                                                                                         AS subinventory                                              ,
                        ODRLINE.unit_list_price_per_pqty                                                                                                                                                                                                                                                                                                                                             AS unit_list_price_per_pqty                                  ,
                        ODRLINE.unit_selling_price_per_pqty                                                                                                                                                                                                                                                                                                                                          AS unit_selling_price_per_pqty                               ,
                        ODRLINE.price_request_code                                                                                                                                                                                                                                                                                                                                                   AS price_request_code                                        ,
                        ODRLINE.gross_booked_amount                                                                                                                                                                                                                                                                                                                                                  AS gross_booked_amount                                       ,
                        ODRLINE.net_booked_amount                                                                                                                                                                                                                                                                                                                                                    AS net_booked_amount                                         ,
                        ODRLINE.discount_amount                                                                                                                                                                                                                                                                                                                                                      AS discount_amount                                           ,
                        ODRLINE.handling_charge                                                                                                                                                                                                                                                                                                                                                      AS handling_charge                                           ,
                        ODRLINE.exempt_amount                                                                                                                                                                                                                                                                                                                                                        AS exempt_amount                                             ,
                        ODRLINE.gross_can_amount                                                                                                                                                                                                                                                                                                                                                     AS gross_can_amount                                          ,
                        ODRLINE.net_can_amount                                                                                                                                                                                                                                                                                                                                                       AS net_can_amount                                            ,
                        ODRLINE.discount_can_amount                                                                                                                                                                                                                                                                                                                                                  AS discount_can_amount                                       ,
                        ODRLINE.handling_can_charge                                                                                                                                                                                                                                                                                                                                                  AS handling_can_charge                                       ,
                        ODRLINE.exempt_can_amount                                                                                                                                                                                                                                                                                                                                                    AS exempt_can_amount                                         ,
                        'Y'                                                                                                                                                                                                                                                                                                                                                                          AS proforma_release_flag                                     ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS attribute16                                               ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS attribute17                                               ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS attribute18                                               ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS attribute19                                               ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS attribute20                                               ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS ordered_date_pst                                          ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS request_date_pst                                          ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS booked_date_pst                                           ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS cancelled_date_pst                                        ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS promise_date_pst                                          ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS schedule_ship_date_pst                                    ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS tax_date_pst                                              ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS pricing_date_pst                                          ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS actual_shipment_date_pst                                  ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS actual_arrival_date_pst                                   ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS schedule_arrival_date_pst                                 ,
                        GC445.cal_445_yyyy                                                                                                                                                                                                                                                                                                                                                           AS cal_445_yyyy                                              ,
                        GC445.cal_445_mm                                                                                                                                                                                                                                                                                                                                                             AS cal_445_mm                                                ,
                        PRDCOST.bus_unit                                                                                                                                                                                                                                                                                                                                                             AS orig_bus_unit                                             ,
                        PRDCOST.prod_num                                                                                                                                                                                                                                                                                                                                                             AS orig_part_number                                          ,
                        NVL(PRDCOST.currency, 'XXX')                                                                                                                                                                                                                                                                                                                                                 AS orig_prod_cost_currency                                   ,
                        NVL(PRDCOST.prod_cost_lcl, 0)                                                                                                                                                                                                                                                                                                                                                AS orig_prod_cost_lcl                                        ,
                        NVL(PRDCOST.prod_cost_usd, 0)                                                                                                                                                                                                                                                                                                                                                AS orig_prod_cost_usd                                        ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS promo_code                                                ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS autho_dealer_attr16                                       ,
                        ODRHDR.nc_promo_attr17                                                                                                                                                                                                                                                                                                                                                       AS nc_promo_attr17                                           ,
                        ODRHDR.nc_promo_description                                                                                                                                                                                                                                                                                                                                                  AS nc_promo_description                                      ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS written_by                                                ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS serial_number                                             ,
                        ODRLINE.pot_salesrep_number                                                                                                                                                                                                                                                                                                                                                  AS pot_salesrep_number                                       ,
                        ODRLINE.pot_salesrep_name                                                                                                                                                                                                                                                                                                                                                    AS pot_salesrep_name                                         ,
                        ODRLINE.pot_territory_id                                                                                                                                                                                                                                                                                                                                                     AS pot_territory_id                                          ,
                        ODRLINE.pot_territory                                                                                                                                                                                                                                                                                                                                                        AS pot_territory                                             ,
                        ODRLINE.pot_territory_name                                                                                                                                                                                                                                                                                                                                                   AS pot_territory_name                                        ,
                        ODRLINE.pot_region                                                                                                                                                                                                                                                                                                                                                           AS pot_region                                                ,
                        ODRLINE.pot_market                                                                                                                                                                                                                                                                                                                                                           AS pot_market                                                ,
                        ODRLINE.pot_country                                                                                                                                                                                                                                                                                                                                                          AS pot_country                                               ,
                        ODRLINE.pot_country_desc                                                                                                                                                                                                                                                                                                                                                     AS pot_country_desc                                          ,
                        ODRLINE.hdr_attribute18                                                                                                                                                                                                                                                                                                                                                      AS hdr_attribute18                                           ,
                        ODRLINE.hdr_attribute19                                                                                                                                                                                                                                                                                                                                                      AS hdr_attribute19                                           ,
                        ODRLINE.hdr_attribute20                                                                                                                                                                                                                                                                                                                                                      AS hdr_attribute20                                           ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS govt_branch_code                                          ,
                        ODRHDR.sales_channel_code                                                                                                                                                                                                                                                                                                                                                    AS sales_channel_code                                        ,
                        ODRHDR.salesrep                                                                                                                                                                                                                                                                                                                                                              AS hdr_salesrep                                              ,
                        (CASE WHEN GLCC.segment2 = '302' THEN 'ALGN' WHEN GLCC.segment2 = '301' THEN 'ORMCO' WHEN GLCC.segment2 = '303' THEN 'INSG' WHEN ODRLINE.ship_from_org_id = 4700 AND     ODRLINE.inventory_item_id IS NOT NULL THEN PRD.company WHEN ODRLINE.ship_from_org_id = 4700 AND     ODRLINE.inventory_item_id IS NULL THEN 'AOA' ELSE NVL(CUST.company, ' || P_BUS_UNIT || ') END ) AS company                                                   ,
                        NVL(ODRLINE.nettable_order_flag, 'Y')                                                                                                                                                                                                                                                                                                                                        AS nettable_order_flag                                       ,
                        NVL(f.user_name, 'UNKNOWN')                                                                                                                                                                                                                                                                                                                                                  AS created_by_name                                           ,
                        NVL(g.user_name, 'UNKNOWN')                                                                                                                                                                                                                                                                                                                                                  AS last_updated_by_name                                      ,
                        (CASE WHEN ODRHDR.flow_status_code = 'CLOSED' THEN 'Shipped' WHEN ODRHDR.flow_status_code = 'CANCELLED' THEN 'Cancelled' ELSE NULL END )                                                                                                                                                                                                                                     AS line_status                                               ,
                        'NOT DEFINED'                                                                                                                                                                                                                                                                                                                                                                AS g_sales_channel                                           ,
                        'NOT DEFINED'                                                                                                                                                                                                                                                                                                                                                                AS pot_channel                                               ,
                        'N'                                                                                                                                                                                                                                                                                                                                                                          AS hold_flag                                                 ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS sales_office                                              ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS sales_office_desc                                         ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS pot_profit_center_code                                    ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS pot_profit_center_desc                                    ,
                        '||p_bus_unit||'                                                                                                                                                                                                                                                                                                                                                             AS sales_org                                                 ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS sales_org_name                                            ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS item_category_code                                        ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS item_category_name                                        ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS item_type_name                                            ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS delivery_block_code                                       ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS delivery_block_name                                       ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS sales_doc_type_code                                       ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS sales_doc_type_name                                       ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS sales_category_code                                       ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS sales_category_name                                       ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS dist_channel_book                                         ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS dist_channel_book_desc                                    ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS on_hold_type                                              ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS on_hold_name                                              ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS bkg_profit_center_code                                    ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS CUSTOMER_GROUP_5                                          ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS CUSTOMER_GROUP_5_DESC                                     ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS PLANT                                                     ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS PLANT_DESC                                                ,
                        NVL(ODRLINE.ship_from_org_id, 9999)                                                                                                                                                                                                                                                                                                                                          AS SHIPPING_POINT                                            ,
                        NULL                                                                                                                                                                                                                                                                                                                                                                         AS SHIPPING_POINT_DESC                                       ,
                        '301'
                                || '-'
                                || NVL(ODRLINE.invoice_to_customer_number, 'NOTDEFINED')
                                || '-'
                                || NVL(ODRLINE.invoice_to_site_use_id, 0) AS PK_CUSTOMER_SOLD_TO_SITE_KEY ,
                        NULL                                              AS PO_NUMBER                    ,
                        NULL                                              AS ACCOUNT                      ,
                        NULL                                              AS CUSTOMER_GROUP_4             ,
                        NULL                                              AS CUSTOMER_GROUP_4_DESC        ,
                        NULL                                              AS ORD_REASON_TXT               ,
                        ODRLINE.hd_order_source_id                        AS HD_ORDER_SOURCE_ID           ,
                        ODRLINE.hd_order_source_name                      AS HD_ORDER_SOURCE_NAME         ,
                        NULL                                              AS COMP_CODE                    ,
                        NULL                                              AS CREATEDBY                    ,
                        NULL                                              AS SALES_DEAL                   ,
                        NULL                                              AS SALES_DEAL_TEXT             ,
                        NULL                                              AS EXT_SYS 
                FROM
                        {{ ref('BRONZE_ORACLE_ERP', 'DW_ORMCO_ORDER_HEADERS')}} ODRHDR
                INNER JOIN
                        {{ ref('BRONZE_ORACLE_ERP', 'DW_ORMCO_ORDER_LINES')}} ODRLINE
                ON
                        ODRHDR.HEADER_ID= ODRLINE.HEADER_ID
                INNER JOIN
                        {{ ref('SILVER', 'DW_GLOBAL_CALENDAR_445')}} GC445
                ON
                        TO_DATE(ODRHDR.BOOKED_DATE) = TO_DATE(GC445.CAL_DATE)
                INNER JOIN
                        {{ ref('BRONZE_ORACLE_ERP', 'DW_ORMCO_CUSTOMERS')}} CUST
                ON
                        ODRHDR.INVOICE_TO_SITE_USE_ID = CUST.SITE_USE_ID
                LEFT JOIN
                        {{ ref('SILVER', 'GW_USERS')}} F
                ON
                        ODRLINE.CREATED_BY = F.USER_ID
                LEFT JOIN
                        {{ ref('SILVER', 'GW_USERS')}} G
                ON
                        ODRLINE.LAST_UPDATED_BY = G.USER_ID
                LEFT JOIN
                        {{ ref('BRONZE_ORACLE_ERP', 'DW_LOCAL_PROD_COSTS')}} PRDCOST
                ON
                        (
                                TO_CHAR(ODRLINE.SHIP_FROM_ORG_ID))     = PRDCOST.WAREHOUSE
                AND     ODRLINE.PRODUCT_NUMBER                         = PRDCOST.PROD_NUM
                AND     ODRLINE.ORDER_QUANTITY_UOM                     = PRDCOST.UNIT_OF_MEASURE
                AND     PRDCOST.BUS_UNIT                               ='301'
                AND     TO_NUMBER(TO_CHAR(ODRLINE.BOOKED_DATE, 'YYYY'))= PRDCOST.CAL_YYYY
                AND     TO_NUMBER(TO_CHAR(ODRLINE.BOOKED_DATE, 'MM'))  = PRDCOST.CAL_MM
                LEFT JOIN
                        {{ ref('BRONZE_ORACLE_ERP', 'DW_ORMCO_PRODUCTS')}} PRD
                ON
                        ODRLINE.SHIP_FROM_ORG_ID =PRD.ORGANIZATION_ID
                AND     ODRLINE.INVENTORY_ITEM_ID=PRD.INVENTORY_ITEM_ID
                LEFT JOIN
                        {{ ref('BRONZE_ORACLE_ERP', 'DW_GL_CODE_COMBINATIONS')}} GLCC
                ON
                        PRD.SALES_ACCOUNT = GLCC.CODE_COMBINATION_ID
                	)
                	*/
            dependencies:
              - locationName: SRC
                nodeName: CUSTOMER
            join:
              joinCondition: FROM {{ ref('SRC', 'CUSTOMER') }} "CUSTOMER"
            name: V_CUSTOMER
            noLinkRefs: []
      name: V_CUSTOMER
      overrideSQL: true
      schema: ""
      sqlType: View
      type: sql
    stepCounter: 1b8b36c2-f581-483e-97c5-e4253fe6e93c
